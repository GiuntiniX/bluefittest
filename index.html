<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terra Insights: O Mercado Fitness</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Montserrat:wght@700;900&display=swap');

        :root {
            --brand-blue: #2563eb;
            --brand-yellow: #facc15;
            --brand-dark: #0f172a;
            --brand-gray: #1e293b;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--brand-dark);
            color: #f1f5f9;
            background-image: 
                linear-gradient(30deg, #0f172a 12%, transparent 12.5%, transparent 87%, #0f172a 87.5%, #0f172a),
                linear-gradient(150deg, #0f172a 12%, transparent 12.5%, transparent 87%, #0f172a 87.5%, #0f172a),
                linear-gradient(30deg, #0f172a 12%, transparent 12.5%, transparent 87%, #0f172a 87.5%, #0f172a),
                linear-gradient(150deg, #0f172a 12%, transparent 12.5%, transparent 87%, #0f172a 87.5%, #0f172a),
                linear-gradient(60deg, #1e293b77 25%, transparent 25.5%, transparent 75%, #1e293b77 75%, #1e293b77),
                linear-gradient(60deg, #1e293b77 25%, transparent 25.5%, transparent 75%, #1e293b77 75%, #1e293b77);
            background-size: 80px 140px;
            background-position: 0 0, 0 0, 40px 70px, 40px 70px, 0 0, 40px 70px;
            background-attachment: fixed;
            overflow-x: hidden;
        }

        h1, h2, h3, .metric-highlight { font-family: 'Montserrat', sans-serif; letter-spacing: -0.03em; }

        .glass-panel {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.4);
            position: relative;
            overflow: hidden;
        }

        .interactive-card { z-index: 1; }
        .interactive-card::before {
            content: ''; position: absolute; inset: 0;
            background-size: cover; background-position: center;
            filter: grayscale(100%) brightness(0.3) contrast(1.2);
            opacity: 0.9; transition: all 0.6s ease-in-out; z-index: -2;
        }
        .interactive-card::after {
            content: ''; position: absolute; inset: 0;
            background: linear-gradient(to top, rgba(15, 23, 42, 0.95), rgba(37, 99, 235, 0.15));
            z-index: -1; transition: all 0.6s ease-in-out;
        }
        .interactive-card:hover::before { filter: grayscale(20%) brightness(0.6) contrast(1.1); transform: scale(1.05); opacity: 1; }
        .interactive-card:hover { border-color: var(--brand-blue); transform: translateY(-5px); }

        .visual-panel {
            position: relative; min-height: 350px; display: flex; flex-direction: column; justify-content: flex-end;
            padding: 2rem; border-radius: 1.5rem; overflow: hidden; border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .visual-panel-bg {
            position: absolute; inset: 0; background-size: cover; background-position: center; transition: transform 1s ease; z-index: -2;
        }
        .visual-panel:hover .visual-panel-bg { transform: scale(1.03); }
        .visual-panel-overlay {
            position: absolute; inset: 0; z-index: -1;
            background: linear-gradient(0deg, rgba(15,23,42,1) 0%, rgba(15,23,42,0.4) 60%, rgba(15,23,42,0.1) 100%);
        }

        .text-gradient {
            background: linear-gradient(to right, #2563eb, #facc15);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        .section-header { border-bottom: 2px solid rgba(255,255,255,0.1); position: relative; padding-bottom: 1rem; margin-bottom: 2.5rem; }
        .section-header::after {
            content: ''; position: absolute; bottom: -2px; left: 0; width: 100px; height: 2px;
            background: linear-gradient(90deg, var(--brand-blue), var(--brand-yellow));
            box-shadow: 0 0 12px var(--brand-blue);
        }

        .brand-bar-container { height: 14px; background-color: rgba(255, 255, 255, 0.1); border-radius: 4px; overflow: hidden; margin-top: 8px; }
        .brand-bar { height: 100%; background-size: 200% 100%; transition: width 1.5s cubic-bezier(0.22, 1, 0.36, 1); position: relative; }
        .bar-gradient-blue { background-image: linear-gradient(90deg, #1d4ed8, #60a5fa); }
        .bar-gradient-yellow { background-image: linear-gradient(90deg, #ca8a04, #facc15); }
        .text-shadow-strong { text-shadow: 0 2px 10px rgba(0,0,0,0.9); }
        
        section { opacity: 0; transform: translateY(30px); transition: all 0.8s ease-out; }
        section.visible { opacity: 1; transform: translateY(0); }

        /* === CONFIGURA√á√ÉO CR√çTICA PARA PDF (BACKGROUND ESCURO) === */
        @media print {
            body { 
                background-color: #0f172a !important; 
                -webkit-print-color-adjust: exact !important;   /* Chrome/Safari/Edge */
                print-color-adjust: exact !important;           /* Firefox */
                color-adjust: exact !important; 
                color: #f1f5f9 !important;
            }
            /* For√ßar fundo nos pain√©is */
            .glass-panel { 
                background-color: rgba(30, 41, 59, 0.9) !important;
                border: 1px solid #444 !important;
                box-shadow: none !important;
            }
            .no-print { display: none !important; }
            /* Evitar quebra de p√°gina no meio de um gr√°fico */
            .glass-panel, .visual-panel, .section-header { page-break-inside: avoid; }
        }
    </style>
</head>
<body class="antialiased min-h-screen">

    <div id="content-wrapper" class="pt-8 px-4 sm:px-8 lg:px-16 max-w-7xl mx-auto pb-32">
        
        <header id="slide-header" class="mb-24 relative z-10">
            <div class="flex justify-between items-center py-6 border-b border-gray-800 mb-8">
                <div class="flex items-center gap-3">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/2/23/Terra_Logo.png" alt="Logo Terra" class="h-8 w-auto">
                    <div class="h-6 w-px bg-gray-600"></div>
                    <span class="text-gray-300 font-bold tracking-wider text-sm">INSIGHTS</span>
                </div>
                <div class="text-xs text-gray-500 font-mono">FITNESS REPORT 2025</div>
            </div>
            
            <div class="relative w-full h-[450px] rounded-3xl overflow-hidden shadow-2xl group">
                <div class="absolute inset-0 bg-cover bg-center" 
                     style="background-image: url('https://images.unsplash.com/photo-1534438327276-14e5300c3a48?q=80&w=2070&auto=format&fit=crop');">
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-[#0f172a] via-[#0f172a]/50 to-transparent"></div>
                
                <div class="absolute bottom-0 left-0 p-8 sm:p-14 w-full md:w-3/4">
                    <span class="inline-block px-3 py-1 mb-4 text-xs font-bold text-blue-900 bg-blue-400 rounded-full uppercase tracking-wide">Bluefit Analysis</span>
                    <h1 class="text-5xl sm:text-7xl font-black text-white leading-none mb-6 drop-shadow-lg">
                        O BRASIL QUE <br>
                        <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-500 via-blue-400 to-yellow-400">TREINA</span>
                    </h1>
                    <p class="text-lg text-gray-300 max-w-2xl font-light text-shadow-strong border-l-4 border-yellow-400 pl-4">
                        H√°bitos, barreiras e a batalha entre o "projeto sa√∫de" e a falta de tempo. Um mergulho nos dados de 539 respondentes.
                    </p>
                </div>
            </div>
        </header>

        <section id="perfil" class="mb-32">
            <h2 class="text-3xl md:text-4xl font-bold section-header text-white">
                01. <span class="text-gradient">Quem √© o P√∫blico?</span>
            </h2>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
                <div class="glass-panel interactive-card p-6 rounded-2xl group">
                    <style>.interactive-card:nth-child(1)::before { background-image: url('https://images.unsplash.com/photo-1571019614242-c5c5dee9f50b?q=80&w=2070&auto=format&fit=crop'); }</style>
                    <div class="absolute top-0 right-0 p-4 opacity-50">
                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-400"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                    </div>
                    <p class="text-xs text-blue-300 uppercase font-bold tracking-widest mb-2 text-shadow-strong">Base Total</p>
                    <p class="text-5xl font-black text-white leading-none mb-2 text-shadow-strong">
                        <span id="counter1" data-target="539" data-decimals="0">0</span>
                    </p>
                    <p class="text-sm text-gray-300">Respondentes (16-34 anos).</p>
                </div>
                <div class="glass-panel interactive-card p-6 rounded-2xl group">
                    <style>.interactive-card:nth-child(2)::before { background-image: url('https://images.unsplash.com/photo-1517836357463-d25dfeac3438?q=80&w=2070&auto=format&fit=crop'); }</style>
                    <div class="absolute top-0 right-0 p-4 opacity-50">
                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-yellow-400"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>
                    </div>
                    <p class="text-xs text-yellow-300 uppercase font-bold tracking-widest mb-2 text-shadow-strong">Classe C</p>
                    <p class="text-5xl font-black text-white leading-none mb-2 text-shadow-strong">
                        <span id="counter2" data-target="56.9" data-decimals="1">0</span>%
                    </p>
                    <p class="text-sm text-gray-300">Maioria da amostra.</p>
                </div>
                <div class="glass-panel interactive-card p-6 rounded-2xl group">
                    <style>.interactive-card:nth-child(3)::before { background-image: url('https://images.unsplash.com/photo-1574680096145-d05b474e2155?q=80&w=2069&auto=format&fit=crop'); }</style>
                    <div class="absolute top-0 right-0 p-4 opacity-50">
                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-400"><path d="M18 20V6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14"/><path d="M2 20h20"/><path d="M14 12v.01"/></svg>
                    </div>
                    <p class="text-xs text-blue-300 uppercase font-bold tracking-widest mb-2 text-shadow-strong">Matriculados</p>
                    <p class="text-5xl font-black text-white leading-none mb-2 text-shadow-strong">
                        <span id="counter3" data-target="45.1" data-decimals="1">0</span>%
                    </p>
                    <p class="text-sm text-gray-300">Taxa geral em academias.</p>
                </div>
                <div class="glass-panel interactive-card p-6 rounded-2xl group">
                    <style>.interactive-card:nth-child(4)::before { background-image: url('https://images.unsplash.com/photo-1599058945522-28d584b6f0ff?q=80&w=2069&auto=format&fit=crop'); }</style>
                    <div class="absolute top-0 right-0 p-4 opacity-50">
                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-yellow-400"><activity points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
                    </div>
                    <p class="text-xs text-yellow-300 uppercase font-bold tracking-widest mb-2 text-shadow-strong">Ativos</p>
                    <p class="text-5xl font-black text-white leading-none mb-2 text-shadow-strong">
                        <span id="counter4" data-target="52.1" data-decimals="1">0</span>%
                    </p>
                    <p class="text-sm text-gray-300">Praticam alguma atividade.</p>
                </div>
            </div>

            <div class="glass-panel p-8 rounded-2xl flex flex-col md:flex-row items-center gap-8">
                <div class="md:w-1/3">
                    <h3 class="text-2xl font-bold text-white mb-2">Disparidade de Matr√≠cula</h3>
                    <p class="text-gray-400 text-sm">Curiosamente, a Classe C apresenta maior taxa de matr√≠cula proporcional que as classes A/B, sugerindo que para A/B existem outras barreiras ou alternativas.</p>
                </div>
                <div class="md:w-2/3 w-full space-y-6" id="matricula-chart" data-ranking="animated" data-unit="%">
                    <div class="ranking-item" data-value="50.16" data-max="55" data-label="Classe C" data-color="bar-gradient-blue"></div>
                    <div class="ranking-item" data-value="38.36" data-max="55" data-label="Classe A/B" data-color="bar-gradient-yellow"></div>
                </div>
            </div>
        </section>

        <section id="barreiras" class="mb-32">
            <h2 class="text-3xl md:text-4xl font-bold section-header text-white">
                02. <span class="text-gradient">O que Impede & O que Move?</span>
            </h2>

            <div class="flex flex-col lg:flex-row gap-8">
                <div class="lg:w-1/2 visual-panel">
                    <div class="visual-panel-bg" style="background-image: url('https://images.unsplash.com/photo-1513593771513-6568e733ac87?q=80&w=2070&auto=format&fit=crop'); background-position: center;"></div>
                    <div class="visual-panel-overlay"></div>
                    <div class="relative z-10">
                        <div class="bg-black/60 backdrop-blur-md p-6 rounded-xl border border-red-500/30 mb-6">
                            <h3 class="text-xl font-bold text-red-400 mb-4 uppercase flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
                                Principal Barreira: Tempo
                            </h3>
                            <div class="space-y-4">
                                <div>
                                    <div class="flex justify-between text-sm text-gray-300 mb-1"><span>Classe A/B (Mais afetada)</span> <span class="font-bold">15.85%</span></div>
                                    <div class="h-2 bg-gray-700 rounded-full"><div class="h-full bg-red-500 rounded-full" style="width: 75%"></div></div>
                                </div>
                                <div>
                                    <div class="flex justify-between text-sm text-gray-300 mb-1"><span>M√©dia Geral</span> <span class="font-bold">11.32%</span></div>
                                    <div class="h-2 bg-gray-700 rounded-full"><div class="h-full bg-red-500/50 rounded-full" style="width: 55%"></div></div>
                                </div>
                            </div>
                            <p class="text-xs text-gray-400 mt-4 italic">Para a Classe C, a "Falta de Motiva√ß√£o" (7,20%) tamb√©m √© um fator relevante.</p>
                        </div>
                    </div>
                </div>

                <div class="lg:w-1/2 glass-panel p-8 rounded-2xl flex flex-col justify-center">
                    <h3 class="text-xl font-bold mb-6 text-yellow-300 uppercase tracking-wide">Drivers de Troca</h3>
                    <div class="space-y-8">
                        <div>
                            <h4 class="text-white font-bold mb-2 flex items-center"><span class="w-3 h-3 bg-blue-500 rounded-full mr-2"></span>Classe C</h4>
                            <p class="text-gray-400 text-sm mb-3">Pragmatismo: Custo-benef√≠cio e facilidade.</p>
                            <div class="flex gap-2">
                                <span class="px-3 py-1 bg-blue-900/50 border border-blue-500/50 rounded text-xs text-blue-200">Proximidade (9.8%)</span>
                                <span class="px-3 py-1 bg-blue-900/50 border border-blue-500/50 rounded text-xs text-blue-200">Promo√ß√µes (8.3%)</span>
                            </div>
                        </div>
                        <div class="h-px bg-gray-700"></div>
                        <div>
                            <h4 class="text-white font-bold mb-2 flex items-center"><span class="w-3 h-3 bg-yellow-500 rounded-full mr-2"></span>Classe A/B</h4>
                            <p class="text-gray-400 text-sm mb-3">Exig√™ncia: Valor percebido e status.</p>
                            <div class="flex gap-2">
                                <span class="px-3 py-1 bg-yellow-900/50 border border-yellow-500/50 rounded text-xs text-yellow-200">Marca Admirada (5.9%)</span>
                                <span class="px-3 py-1 bg-yellow-900/50 border border-yellow-500/50 rounded text-xs text-yellow-200">Qualidade</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="objetivos" class="mb-32">
            <h2 class="text-3xl md:text-4xl font-bold section-header text-white">
                03. <span class="text-gradient">O Treino & O Bolso</span>
            </h2>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="glass-panel p-6 rounded-2xl md:col-span-2">
                    <h3 class="text-xl font-bold mb-6 text-white">O Foco do Treino</h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
                        <div class="p-4 rounded-xl bg-blue-600/10 border border-blue-500/20">
                            <div class="text-3xl mb-2">ü©∫</div>
                            <h4 class="font-bold text-blue-400 mb-1">Classe C</h4>
                            <p class="text-sm text-gray-300">Busca prim√°ria por <strong>Sa√∫de</strong> e <strong>Redu√ß√£o de Estresse</strong>. Modalidades simples como Caminhada e Corrida dominam.</p>
                        </div>
                        <div class="p-4 rounded-xl bg-yellow-600/10 border border-yellow-500/20">
                            <div class="text-3xl mb-2">üí™</div>
                            <h4 class="font-bold text-yellow-400 mb-1">Classe A/B</h4>
                            <p class="text-sm text-gray-300">Foco em <strong>Est√©tica</strong> e <strong>Emagrecimento</strong>. Interesse maior em modalidades diferenciadas e equipamentos de ponta.</p>
                        </div>
                    </div>
                </div>

                <div class="visual-panel justify-center items-center text-center">
                    <div class="visual-panel-bg" style="background-image: url('https://images.unsplash.com/photo-1554224155-8d04cb21cd6c?q=80&w=2070&auto=format&fit=crop');"></div>
                    <div class="visual-panel-overlay"></div>
                    <div class="relative z-10">
                        <p class="text-xs font-bold text-gray-400 uppercase mb-2">Teste de Oferta</p>
                        <h3 class="text-4xl font-black text-white mb-1">R$ 159,90</h3>
                        <p class="text-sm text-gray-300 mb-6">Mensalidade</p>
                        
                        <div class="bg-black/80 p-4 rounded-lg text-left space-y-3">
                            <div>
                                <div class="flex justify-between text-xs text-blue-300 mb-1"><span>Classe C (Aceita√ß√£o)</span> <span>24%</span></div>
                                <div class="h-1.5 bg-gray-700 rounded"><div class="h-full bg-blue-500 rounded" style="width: 24%"></div></div>
                            </div>
                            <div>
                                <div class="flex justify-between text-xs text-red-300 mb-1"><span>Classe A/B (Rejei√ß√£o)</span> <span>26%</span></div>
                                <div class="h-1.5 bg-gray-700 rounded"><div class="h-full bg-red-500 rounded" style="width: 26%"></div></div>
                            </div>
                        </div>
                        <p class="text-[10px] text-gray-400 mt-2">A/B exige benef√≠cios premium para justificar.</p>
                    </div>
                </div>
            </div>
        </section>

        <footer class="border-t border-gray-800 pt-10 text-center">
            <img src="https://upload.wikimedia.org/wikipedia/commons/2/23/Terra_Logo.png" alt="Terra" class="h-6 mx-auto mb-4 opacity-50">
            <p class="text-gray-500 text-xs leading-relaxed">
                ¬© 2025 Pesquisa Terra Insights ‚Ä¢ O Mercado Fitness<br>
                Imagens meramente ilustrativas (Fonte: Unsplash).
            </p>
        </footer>

    </div>

    <div class="fixed bottom-0 left-0 w-full z-50 p-4 bg-gray-900/95 backdrop-blur-md border-t border-gray-800 flex flex-col md:flex-row items-center justify-center gap-4 no-print shadow-2xl">
        <button onclick="downloadPDF()" class="flex items-center gap-2 bg-gray-800 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-xl border border-gray-600 transition-all shadow-lg w-full md:w-auto justify-center">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
            Baixar PDF (Visual Fiel)
        </button>
        <button onclick="generateNativePPT()" id="btn-ppt" class="flex items-center gap-2 bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-6 rounded-xl transition-all shadow-lg w-full md:w-auto justify-center">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 4h8a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"/><path d="M6 12h9a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"/></svg>
            Baixar PPT (Edit√°vel)
        </button>
        <p class="text-[10px] text-gray-500 md:absolute md:right-4 mt-2 md:mt-0">
            *PDF: Marque "Gr√°ficos de Plano de Fundo" na impress√£o.
        </p>
    </div>

    <script>
        // --- ANIMA√á√ÉO (Igual ao anterior) ---
        const ANIMATION_DURATION = 1500; 
        
        function animateCounter(element, start, end, decimals) {
            let startTime;
            const step = (timestamp) => {
                if (!startTime) startTime = timestamp;
                const progress = timestamp - startTime;
                const ease = (x) => x === 1 ? 1 : 1 - Math.pow(2, -10 * x);
                const percentage = Math.min(progress / ANIMATION_DURATION, 1);
                let current = ease(percentage) * (end - start) + start;
                element.textContent = current.toFixed(decimals);
                if (progress < ANIMATION_DURATION) window.requestAnimationFrame(step);
                else element.textContent = end.toFixed(decimals);
            };
            window.requestAnimationFrame(step);
        }

        function animateBars(container) {
            if (container.classList.contains('animated')) return;
            container.classList.add('animated');
            const unit = container.getAttribute('data-unit') || '';
            const items = container.querySelectorAll('.ranking-item');
            items.forEach((item, index) => {
                const val = parseFloat(item.getAttribute('data-value'));
                const max = parseFloat(item.getAttribute('data-max'));
                const label = item.getAttribute('data-label');
                const colorClass = item.getAttribute('data-color');
                const uniqueId = `bar-${Math.random().toString(36).substr(2, 9)}`;
                const width = Math.min(100, (val / max) * 100);
                item.innerHTML = `
                    <div class="flex justify-between items-end mb-2">
                        <span class="font-bold text-sm text-gray-200 uppercase tracking-wide">${label}</span>
                        <span class="text-lg font-bold text-white font-mono" id="${uniqueId}-val">0${unit}</span>
                    </div>
                    <div class="brand-bar-container">
                        <div class="brand-bar ${colorClass} shadow-[0_0_10px_rgba(37,99,235,0.3)]" style="width: 0%"></div>
                    </div>`;
                setTimeout(() => {
                    const bar = item.querySelector('.brand-bar');
                    const valEl = item.querySelector(`#${uniqueId}-val`);
                    bar.style.width = `${width}%`;
                    animateCounter(valEl, 0, val, (unit === '%' ? 1 : 0));
                }, index * 200);
            });
        }

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    const counters = entry.target.querySelectorAll('[id^="counter"]');
                    counters.forEach(c => {
                        if(!c.classList.contains('done')) {
                            c.classList.add('done');
                            animateCounter(c, 0, parseFloat(c.getAttribute('data-target')), parseInt(c.getAttribute('data-decimals')));
                        }
                    });
                    const rankings = entry.target.querySelectorAll('[data-ranking="animated"]');
                    rankings.forEach(r => animateBars(r));
                }
            });
        }, { threshold: 0.15 });

        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('section').forEach(section => observer.observe(section));
        });

        // --- DOWNLOAD PDF (Simples e Eficiente) ---
        function downloadPDF() {
            window.print();
        }

        // --- GERADOR DE PPT NATIVO (Novo c√≥digo robusto) ---
        function generateNativePPT() {
            const btn = document.getElementById('btn-ppt');
            btn.innerHTML = 'Gerando...';
            
            try {
                let pptx = new PptxGenJS();
                pptx.layout = 'LAYOUT_16x9';
                pptx.author = 'Terra Insights';
                pptx.company = 'Terra';
                pptx.title = 'Fitness Report 2025';

                // Cores
                const BLUE = "2563eb";
                const YELLOW = "facc15";
                const DARK = "0f172a";
                const WHITE = "ffffff";

                // Slide 1: Capa
                let slide1 = pptx.addSlide();
                slide1.background = { color: DARK };
                slide1.addText("O BRASIL QUE TREINA", { x: 0.5, y: 2, w: '90%', fontSize: 44, color: WHITE, bold: true, align: 'left' });
                slide1.addText("Terra Insights: Fitness Report 2025", { x: 0.5, y: 3, w: '90%', fontSize: 18, color: YELLOW });
                slide1.addText("Metodologia: Base de 539 respondentes.", { x: 0.5, y: 5, fontSize: 12, color: "aaaaaa" });

                // Slide 2: Perfil do P√∫blico
                let slide2 = pptx.addSlide();
                slide2.background = { color: WHITE };
                slide2.addText("01. Quem √© o P√∫blico?", { x: 0.5, y: 0.5, fontSize: 24, color: BLUE, bold: true });
                
                // Cards de dados
                slide2.addShape(pptx.ShapeType.rect, { x: 0.5, y: 1.5, w: 2.5, h: 1.5, fill: BLUE });
                slide2.addText("539\nRespondentes", { x: 0.5, y: 1.5, w: 2.5, h: 1.5, fontSize: 18, color: WHITE, align: 'center', valign: 'middle' });

                slide2.addShape(pptx.ShapeType.rect, { x: 3.2, y: 1.5, w: 2.5, h: 1.5, fill: YELLOW });
                slide2.addText("56.9%\nClasse C", { x: 3.2, y: 1.5, w: 2.5, h: 1.5, fontSize: 18, color: DARK, align: 'center', valign: 'middle' });

                slide2.addShape(pptx.ShapeType.rect, { x: 5.9, y: 1.5, w: 2.5, h: 1.5, fill: BLUE });
                slide2.addText("45.1%\nMatriculados", { x: 5.9, y: 1.5, w: 2.5, h: 1.5, fontSize: 18, color: WHITE, align: 'center', valign: 'middle' });

                slide2.addText("Insight Importante:", { x: 0.5, y: 3.5, fontSize: 14, color: DARK, bold: true });
                slide2.addText("A Classe C apresenta maior taxa de matr√≠cula proporcional (50.16%) que as classes A/B (38.36%), sugerindo barreiras diferentes de entrada para p√∫blicos de alta renda.", { x: 0.5, y: 3.8, w: '90%', fontSize: 12, color: "666666" });

                // Slide 3: Barreiras e Drivers
                let slide3 = pptx.addSlide();
                slide3.background = { color: WHITE };
                slide3.addText("02. Barreiras e Motiva√ß√µes", { x: 0.5, y: 0.5, fontSize: 24, color: BLUE, bold: true });

                slide3.addText("Principal Barreira: FALTA DE TEMPO", { x: 0.5, y: 1.5, fontSize: 16, color: "DD0000", bold: true });
                slide3.addText("‚Ä¢ Afeta 15.85% da Classe A/B (Maior √≠ndice)\n‚Ä¢ M√©dia geral de 11.32%\n‚Ä¢ Classe C tamb√©m cita 'Falta de Motiva√ß√£o' (7.2%)", { x: 0.5, y: 1.8, fontSize: 12, color: DARK });

                slide3.addText("O que faz mudar de academia?", { x: 5.5, y: 1.5, fontSize: 16, color: DARK, bold: true });
                slide3.addText("Classe C (Pragmatismo):", { x: 5.5, y: 1.8, fontSize: 12, color: BLUE, bold: true });
                slide3.addText("‚Ä¢ Proximidade (9.8%)\n‚Ä¢ Promo√ß√µes (8.3%)", { x: 5.5, y: 2.1, fontSize: 12, color: DARK });
                
                slide3.addText("Classe A/B (Exig√™ncia):", { x: 5.5, y: 3.0, fontSize: 12, color: "#CA8A04", bold: true });
                slide3.addText("‚Ä¢ Marca Admirada (5.9%)\n‚Ä¢ Qualidade percebida", { x: 5.5, y: 3.3, fontSize: 12, color: DARK });

                // Slide 4: Oferta e Pre√ßo
                let slide4 = pptx.addSlide();
                slide4.background = { color: DARK };
                slide4.addText("03. Teste de Oferta: R$ 159,90", { x: 0.5, y: 0.5, fontSize: 24, color: YELLOW, bold: true });

                slide4.addShape(pptx.ShapeType.rect, { x: 1, y: 2, w: 4, h: 3, fill: "1e293b", line: {color: "ffffff", width: 1} });
                slide4.addText("Classe C\nACEITA√á√ÉO", { x: 1, y: 2.5, w: 4, align: 'center', color: BLUE, bold: true });
                slide4.addText("24%", { x: 1, y: 3.2, w: 4, align: 'center', fontSize: 30, color: WHITE, bold: true });

                slide4.addShape(pptx.ShapeType.rect, { x: 6, y: 2, w: 4, h: 3, fill: "1e293b", line: {color: "ffffff", width: 1} });
                slide4.addText("Classe A/B\nREJEI√á√ÉO", { x: 6, y: 2.5, w: 4, align: 'center', color: "FF5555", bold: true });
                slide4.addText("26%", { x: 6, y: 3.2, w: 4, align: 'center', fontSize: 30, color: WHITE, bold: true });

                slide4.addText("Conclus√£o: Para o p√∫blico A/B, o pre√ßo sozinho n√£o justifica a troca. √â necess√°rio agregar benef√≠cios premium.", { x: 1, y: 5.5, w: '80%', align: 'center', color: "aaaaaa", fontSize: 11, italic: true });

                pptx.writeFile({ fileName: "Terra_Insights_Fitness.pptx" });
                btn.innerHTML = 'Baixar PPT (Edit√°vel)';

            } catch (e) {
                console.error(e);
                alert("Erro ao gerar PPT.");
                btn.innerHTML = 'Tentar Novamente';
            }
        }
    </script>
</body>
</html>
